# Pre-push: Run E2E tests with real services
# Requires:
#   ~/.deca/credentials/anthropic.json (for Agent E2E)
#   ~/.deca/credentials/discord.json with webhookUrl, testChannelId (for Discord E2E)

echo "üöÄ Running E2E tests before push..."

# Check Agent credentials
if [ ! -f "$HOME/.deca/credentials/anthropic.json" ]; then
  echo "‚ö†Ô∏è  Warning: No Anthropic credentials found"
  echo "   Agent E2E tests may fail."
fi

# Check Discord credentials
if [ ! -f "$HOME/.deca/credentials/discord.json" ]; then
  echo "‚ö†Ô∏è  Warning: No Discord credentials found"
  echo "   Discord E2E tests may fail."
fi

# Run E2E tests
bun run test:e2e

echo "‚úÖ E2E tests passed!"
